---
import { cn } from "@/lib/utils";
import { SITE_TITLE } from "../consts";
import HeaderLink from "./HeaderLink.astro";
import { ThemeToggle } from "./Theme/theme-toggle.tsx";
import { MobileNav } from "@/components/ui/nav/mobile-nav.tsx";
import {
  SearchIcon,
  Shield,
  Home,
  User,
  FolderOpen,
  Lock,
} from "@lucide/astro";

const getDisplayTitle = (pathname: string) => {
  if (pathname === "/") return "C:\\GPR\\ARCHIVE\\HOME.CMD";
  if (pathname.startsWith("/projects")) return "C:\\GPR\\ARCHIVE\\PROJECTS.DIR";
  if (pathname.startsWith("/build")) return "C:\\GPR\\DATA\\BUILD_LOG.FILE";
  if (pathname.startsWith("/learning")) return "C:\\GPR\\SYSTEM\\LEARN.LOG";
  if (pathname.startsWith("/case-file"))
    return "C:\\GPR\\ACCESS\\RESTRICTED.FILE";
  return "C:\\GPR\\SYSTEM\\STATUS.OK";
};

const pathname = Astro.url.pathname;
const systemPath = getDisplayTitle(pathname.toLowerCase());

const headerClasses = cn(
  "sticky top-0 z-50",
  "bg-background/80 backdrop-blur-sm border-b border-border/80"
);
---

<div
  class="fixed top-0 left-0 right-0 z-50 transition-colors duration-300 h-16 md:h-20 backdrop-blur-sm bg-background/95 border-b border-border/80 pl-0"
>
  <header class={headerClasses}>
    <div
      class="w-full h-full max-w-[1440px] mx-auto px-4 md:px-2 flex justify-between items-center"
    >
      <div class="flex-shrink-0">
        <HeaderLink href="/" class="flex items-center gap-2 group">
          <Shield class="text-lg h-6 w-6 animate-pulse" />
          <span class="text-xl font-bold neon-text">G. ROTHSTEIN</span>
        </HeaderLink>
      </div>

      <div class="flex gap-6 items-center">
        <HeaderLink href="/" class="">
          <Home class="h-4 w-4" />
          <span>HQ</span>
        </HeaderLink>

        <HeaderLink href="/profile" class="">
          <User class="h-4 w-4" />
          <span>Profile</span>
        </HeaderLink>

        <HeaderLink href="/cases" class="">
          <FolderOpen class="h-4 w-4" />
          <span>Cases</span>
        </HeaderLink>

        <HeaderLink href="/blog" class="">
          <FolderOpen class="h-4 w-4" />
          <span>Blog</span>
        </HeaderLink>

        <HeaderLink href="/classified" class="">
          <Lock class="h-4 w-4" />
          <span>Classified</span>
        </HeaderLink>

        <div class="flex items-center space-x-4 flex-shrink-0 gap-1 m-2 p-0">
          <button
            class="text-accent hover:text-foreground transition-colors"
            aria-label="Search the portfolio"
          >
            <i>
              <SearchIcon class="h-6 w-6" />
            </i>
          </button>
          <ThemeToggle client:load />
          <div class="md:hidden">
            <MobileNav client:media="(max-width: 50em)" />
          </div>
        </div>
      </div>
    </div>
  </header>
  <div class="path-wrapper border-b bg-accent text-muted border-border/80">
    <div class="container mx-auto px-4 py-2">
      <p class="text-xs md:text-sm font-mono">
        <span
          class={cn(
            "text-sm font-mono tracking-wider uppercase px-4 py-1 rounded-sm",
            "transition-colors duration-300",
            pathname.startsWith("/case-file")
              ? "text-destructive shadow-color-destructive/30"
              : "text-muted shadow-color-accent/30"
          )}
        >
          {systemPath}
        </span>
      </p>
    </div>
  </div>
</div>
